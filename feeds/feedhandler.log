2026-01-26 17:27:37,298 : WARNING : BINANCE.ws.1: encountered connection issue Cannot connect to host api.binance.com:443 ssl:default [Domain name not found] - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/resolver.py", line 117, in resolve
    resp = await self._resolver.getaddrinfo(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
aiodns.error.DNSError: (4, 'Domain name not found')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/resolver.py", line 126, in resolve
    raise OSError(None, msg) from exc
OSError: [Errno None] Domain name not found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 65, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 99, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 516, in message_handler
    await self._book(msg, pair, timestamp)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 317, in _book
    await self._snapshot(exchange_pair)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 282, in _snapshot
    resp = await self.http_conn.read(self.rest_endpoints[0].route('l2book', self.sandbox).format(pair, max_depth))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection.py", line 168, in read
    async with self.conn.get(address, headers=header, params=params, proxy=self.proxy) as response:
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 1510, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 779, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 734, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        req, traces=traces, timeout=real_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1538, in _create_direct_connection
    raise ClientConnectorDNSError(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorDNSError: Cannot connect to host api.binance.com:443 ssl:default [Domain name not found]
2026-01-26 17:27:45,262 : WARNING : BINANCE.ws.1: encountered connection issue Cannot connect to host api.binance.com:443 ssl:default [Domain name not found] - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/resolver.py", line 117, in resolve
    resp = await self._resolver.getaddrinfo(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
aiodns.error.DNSError: (4, 'Domain name not found')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/resolver.py", line 126, in resolve
    raise OSError(None, msg) from exc
OSError: [Errno None] Domain name not found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 65, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 99, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 516, in message_handler
    await self._book(msg, pair, timestamp)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 317, in _book
    await self._snapshot(exchange_pair)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 282, in _snapshot
    resp = await self.http_conn.read(self.rest_endpoints[0].route('l2book', self.sandbox).format(pair, max_depth))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection.py", line 168, in read
    async with self.conn.get(address, headers=header, params=params, proxy=self.proxy) as response:
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 1510, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 779, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 734, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        req, traces=traces, timeout=real_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1538, in _create_direct_connection
    raise ClientConnectorDNSError(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorDNSError: Cannot connect to host api.binance.com:443 ssl:default [Domain name not found]
2026-01-26 17:28:59,466 : WARNING : BINANCE.ws.1: encountered connection issue Cannot connect to host 127.0.0.1:7890 ssl:default [Connect call failed ('127.0.0.1', 7890)] - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1268, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 122, in start_connection
    raise first_exception
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 73, in start_connection
    sock = await _connect_sock(
           ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 208, in _connect_sock
    await loop.sock_connect(sock, address)
  File "uvloop/loop.pyx", line 2633, in sock_connect
  File "uvloop/loop.pyx", line 1108, in uvloop.loop.Loop._sock_connect_cb
ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 7890)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 65, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 99, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 516, in message_handler
    await self._book(msg, pair, timestamp)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 317, in _book
    await self._snapshot(exchange_pair)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 282, in _snapshot
    resp = await self.http_conn.read(self.rest_endpoints[0].route('l2book', self.sandbox).format(pair, max_depth))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection.py", line 168, in read
    async with self.conn.get(address, headers=header, params=params, proxy=self.proxy) as response:
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 1510, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 779, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 734, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        req, traces=traces, timeout=real_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1207, in _create_connection
    _, proto = await self._create_proxy_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1606, in _create_proxy_connection
    transport, proto = await self._create_direct_connection(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        proxy_req, [], timeout, client_error=ClientProxyConnectionError
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1581, in _create_direct_connection
    raise last_exc
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1550, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1291, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientProxyConnectionError: Cannot connect to host 127.0.0.1:7890 ssl:default [Connect call failed ('127.0.0.1', 7890)]
2026-01-26 17:29:08,344 : WARNING : BINANCE.ws.1: encountered connection issue Cannot connect to host 127.0.0.1:7890 ssl:default [Connect call failed ('127.0.0.1', 7890)] - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1268, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 122, in start_connection
    raise first_exception
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 73, in start_connection
    sock = await _connect_sock(
           ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 208, in _connect_sock
    await loop.sock_connect(sock, address)
  File "uvloop/loop.pyx", line 2633, in sock_connect
  File "uvloop/loop.pyx", line 1108, in uvloop.loop.Loop._sock_connect_cb
ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 7890)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 65, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 99, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 516, in message_handler
    await self._book(msg, pair, timestamp)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 317, in _book
    await self._snapshot(exchange_pair)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 282, in _snapshot
    resp = await self.http_conn.read(self.rest_endpoints[0].route('l2book', self.sandbox).format(pair, max_depth))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection.py", line 168, in read
    async with self.conn.get(address, headers=header, params=params, proxy=self.proxy) as response:
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 1510, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 779, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 734, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        req, traces=traces, timeout=real_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1207, in _create_connection
    _, proto = await self._create_proxy_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1606, in _create_proxy_connection
    transport, proto = await self._create_direct_connection(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        proxy_req, [], timeout, client_error=ClientProxyConnectionError
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1581, in _create_direct_connection
    raise last_exc
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1550, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1291, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientProxyConnectionError: Cannot connect to host 127.0.0.1:7890 ssl:default [Connect call failed ('127.0.0.1', 7890)]
2026-01-26 17:29:14,862 : WARNING : BINANCE.ws.1: encountered connection issue Cannot connect to host 127.0.0.1:7890 ssl:default [Connect call failed ('127.0.0.1', 7890)] - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1268, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 122, in start_connection
    raise first_exception
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 73, in start_connection
    sock = await _connect_sock(
           ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 208, in _connect_sock
    await loop.sock_connect(sock, address)
  File "uvloop/loop.pyx", line 2633, in sock_connect
  File "uvloop/loop.pyx", line 1108, in uvloop.loop.Loop._sock_connect_cb
ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 7890)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 65, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 99, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 516, in message_handler
    await self._book(msg, pair, timestamp)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 317, in _book
    await self._snapshot(exchange_pair)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 282, in _snapshot
    resp = await self.http_conn.read(self.rest_endpoints[0].route('l2book', self.sandbox).format(pair, max_depth))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection.py", line 168, in read
    async with self.conn.get(address, headers=header, params=params, proxy=self.proxy) as response:
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 1510, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 779, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 734, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        req, traces=traces, timeout=real_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1207, in _create_connection
    _, proto = await self._create_proxy_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1606, in _create_proxy_connection
    transport, proto = await self._create_direct_connection(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        proxy_req, [], timeout, client_error=ClientProxyConnectionError
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1581, in _create_direct_connection
    raise last_exc
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1550, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1291, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientProxyConnectionError: Cannot connect to host 127.0.0.1:7890 ssl:default [Connect call failed ('127.0.0.1', 7890)]
2026-01-26 17:34:04,421 : WARNING : BINANCE.ws.1: encountered connection issue Cannot connect to host 127.0.0.1:7890 ssl:default [Connect call failed ('127.0.0.1', 7890)] - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1268, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 122, in start_connection
    raise first_exception
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 73, in start_connection
    sock = await _connect_sock(
           ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 208, in _connect_sock
    await loop.sock_connect(sock, address)
  File "uvloop/loop.pyx", line 2633, in sock_connect
  File "uvloop/loop.pyx", line 1108, in uvloop.loop.Loop._sock_connect_cb
ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 7890)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 65, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 99, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 516, in message_handler
    await self._book(msg, pair, timestamp)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 317, in _book
    await self._snapshot(exchange_pair)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 282, in _snapshot
    resp = await self.http_conn.read(self.rest_endpoints[0].route('l2book', self.sandbox).format(pair, max_depth))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection.py", line 168, in read
    async with self.conn.get(address, headers=header, params=params, proxy=self.proxy) as response:
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 1510, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 779, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 734, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        req, traces=traces, timeout=real_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1207, in _create_connection
    _, proto = await self._create_proxy_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1606, in _create_proxy_connection
    transport, proto = await self._create_direct_connection(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        proxy_req, [], timeout, client_error=ClientProxyConnectionError
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1581, in _create_direct_connection
    raise last_exc
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1550, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1291, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientProxyConnectionError: Cannot connect to host 127.0.0.1:7890 ssl:default [Connect call failed ('127.0.0.1', 7890)]
2026-01-26 17:34:11,398 : WARNING : BINANCE.ws.1: encountered connection issue Cannot connect to host 127.0.0.1:7890 ssl:default [Connect call failed ('127.0.0.1', 7890)] - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1268, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 122, in start_connection
    raise first_exception
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 73, in start_connection
    sock = await _connect_sock(
           ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohappyeyeballs/impl.py", line 208, in _connect_sock
    await loop.sock_connect(sock, address)
  File "uvloop/loop.pyx", line 2633, in sock_connect
  File "uvloop/loop.pyx", line 1108, in uvloop.loop.Loop._sock_connect_cb
ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 7890)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 65, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection_handler.py", line 99, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 516, in message_handler
    await self._book(msg, pair, timestamp)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 317, in _book
    await self._snapshot(exchange_pair)
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/exchanges/binance.py", line 282, in _snapshot
    resp = await self.http_conn.read(self.rest_endpoints[0].route('l2book', self.sandbox).format(pair, max_depth))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/cryptofeed/connection.py", line 168, in read
    async with self.conn.get(address, headers=header, params=params, proxy=self.proxy) as response:
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 1510, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 779, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/client.py", line 734, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        req, traces=traces, timeout=real_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1207, in _create_connection
    _, proto = await self._create_proxy_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1606, in _create_proxy_connection
    transport, proto = await self._create_direct_connection(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        proxy_req, [], timeout, client_error=ClientProxyConnectionError
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1581, in _create_direct_connection
    raise last_exc
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1550, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/Users/fangxinniu/Projects/cryptofeed/.venv/bin/.venv/lib/python3.14/site-packages/aiohttp/connector.py", line 1291, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientProxyConnectionError: Cannot connect to host 127.0.0.1:7890 ssl:default [Connect call failed ('127.0.0.1', 7890)]
